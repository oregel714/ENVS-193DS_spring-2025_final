---
title: "193DS_final"
author: "Mark Oregel"
date: "June 11, 2025"
format: html
  html: 
    toc: true 
    toc-depth: 5
---

### GitHub repository: 
https://github.com/oregel714/ENVS-193DS_spring-2025_final

```{r, message=FALSE}

# reading in packages 
library(tidyverse)
library(here)
library(gt)
library(janitor)
library(readxl)
library(dplyr)
library(MuMIn)
library(DHARMa)
library(lubridate)

# reading in data set 

sst <- read_csv(here("data", "SST_update2023.csv"))

nest_boxes <- read_csv(here("data", "occdist.csv"))

```




# Problem 1: 

a. In part 1, they used a Pearson's correlation test as this would mean that we are trying to understand if there is a correlation between distance from headwater and total nitrogen load. 
In part 2, they used a linear model to determine if there the source of nitrogen influences average nitrogen load. 

b. 




# Problem 2: 

a. Cleaning and Summarizing 

```{r, message=FALSE}

sst_clean <- sst |> # creating new data object from original data set
  select(date, temp) |> # selecting relevant 
  mutate( # changing columns to year and date 
    year = year(date), # specifiying dat as a year  
    month = month(date, label = TRUE, abbr = TRUE) # label and abbreviate the month date 
  ) |> 
  filter(year %in% c(2018, 2019, 2020, 2021, 2022, 2023)) |> # filtering the data for only the specified years 
  select(-date) |> # getting rid of the original date column 
  group_by(year, month) |> # grouping by year and month 
  summarise(mean_monthly_sst = mean(temp, na.rm = TRUE), .groups = "drop")  |> # summarizing  the mean monthly surface temperatures 
  mutate(mean_monthly_sst = round(mean_monthly_sst, 1), year = as.factor(year)) # changing the 'mean_monthly_sst' to be rounded and setting 'year' as a factor 

sst_clean |> # taking the 'sst_clean' object and sampling 5 observations 
  slice_sample(n=5)

str(sst_clean) # displaying the sample 
```

b. Visualization 
```{r, message=FALSE}

ggplot(data = sst_clean, # starting with data set 'sst_clean' 
       aes(x = month, # setting x axis as 'month'
           y = mean_monthly_sst, # setting y axis as 'mean_monthly_sst'
           group = year, # grouping by year 
           color = year # coloring the year 
           )) +
  geom_line(size = 1) + # setting the size of the line 
  geom_point(size = 2) + # setting the size of the points representing the means
  scale_color_manual( # setting the colors of each year manually 
    values = c(
      "2018" = "#292f56",
      "2019" = "#1e4572",
      "2020" = "#005c8b",
      "2021" = "#007498",
      "2022" = "#008ba0",
      "2023" = "#00a3a4"
    )
  ) +
  scale_x_discrete( # abbreviating the months on the x axis 
    limits = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) +
  
  theme_bw() + # setting the theme to black and white 
  labs(y = "Mean monthly sea surface temperature (Â°C)", # setting titles for axes 
       x = "Month",
       color = "Year"
       ) + 
  theme( # changing the size/position of the text in the legend and axes to fit the graph 
    legend.position = c(0.1, 0.75), 
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10),
    axis.title = element_text(size = 13),
    axis.text = element_text(size = 11),
    panel.grid.major = element_blank(), # removing the grids/panels in the back of the graph
    panel.grid.minor = element_blank(),
    
  )
```

# Problem 3: 

```{r, message=FALSE}

clean_nb <- nest_boxes |>
  clean_names() |>
  select(-box, -event_id, -repeated_use) |>
  mutate(season = as.factor(season))

```


a. 

